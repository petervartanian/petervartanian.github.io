<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    {%- assign meta_title = page.title | default: site.title -%}
    {%- assign meta_description = page.excerpt | default: site.description -%}
    
    <title>{% if page.title %}{{ page.title }} · {% endif %}{{ site.title }}</title>
    
    {% seo %}
    
    <meta name="description" content="{{ meta_description | strip_newlines | strip | escape }}">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0a0514">
    
    <link rel="icon" type="image/png" sizes="32x32" href="{{ '/assets/img/favicon-32x32.png' | relative_url }}">
    <link rel="icon" type="image/png" sizes="16x16" href="{{ '/assets/img/favicon-16x16.png' | relative_url }}">
    <link rel="apple-touch-icon" sizes="180x180" href="{{ '/assets/img/apple-touch-icon.png' | relative_url }}">
    <link rel="manifest" href="{{ '/manifest.json' | relative_url }}">
    
    <link rel="canonical" href="{{ page.url | absolute_url }}">
    <link rel="alternate" type="application/rss+xml" title="{{ site.title }}" href="{{ '/feed.xml' | absolute_url }}">
    
    <style>
      :root{--bg:#0a0514;--card:#f8f3e8;--ink:#1a1410;--accent:#4a5fd9;--glow:#d946a6;--muted:#8a7f72}*{box-sizing:border-box}body{margin:0;background:radial-gradient(ellipse at top,#1a1434 0%,var(--bg) 60%);color:var(--ink);font-family:"Iowan Old Style","Palatino Linotype",Palatino,"Book Antiqua",Georgia,serif;line-height:1.7;font-size:17px;min-height:100vh}.pv-page{min-height:100vh;display:flex;flex-direction:column;max-width:1400px;margin:0 auto}.skip-link{position:absolute;top:-100px;left:0;background:var(--accent);color:var(--card);padding:.75rem 1.5rem;text-decoration:none;z-index:1000;font-weight:600}.skip-link:focus{top:0;outline:3px solid var(--glow);outline-offset:2px}
    </style>
    
    <link rel="preload" href="{{ '/assets/css/style.css' | relative_url }}" as="style">
    <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
    
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "{{ site.title }}",
      "url": "{{ site.url }}",
      "description": "{{ site.description }}",
      "email": "{{ site.author.email }}",
      "jobTitle": "Scholar and Researcher",
      "sameAs": ["https://github.com/{{ site.github_username }}"],
      "knowsAbout": ["Geopolitics", "Technology", "Critical Infrastructure", "Strategic Foresight"]
    }
    </script>
    
    <script>
      if('serviceWorker' in navigator){
        window.addEventListener('load',function(){
          navigator.serviceWorker.register('/sw.js');
        });
      }
    </script>
  </head>
  <body class="{% assign p = page.permalink | default: page.url %}{% if p == '/' %}pv-about{% elsif p == '/projects' %}pv-projects{% elsif p == '/media' %}pv-media{% elsif p == '/cv' %}pv-cv{% elsif p == '/contact' %}pv-contact{% else %}pv-default{% endif %}">
    
    <div class="reading-progress" role="progressbar" aria-label="Reading progress"></div>
    
    <a href="#main-content" class="skip-link">skip to content</a>
    
    <div class="pv-page">
      <header class="pv-header" role="banner">
        <div class="pv-header-inner">
          <a class="pv-brand" href="{{ '/' | relative_url }}" aria-label="Return to homepage">
            <span class="pv-brand-title">{{ site.title }}</span>
            <span class="pv-brand-tagline">{{ site.description }}</span>
          </a>
        </div>
      </header>

      <main class="pv-main" role="main">
        <nav class="pv-side-index" aria-label="Primary navigation">
          {% assign current = page.permalink | default: page.url %}
          <ul class="pv-side-list">
            {% for item in site.navigation %}
              <li>
                <a class="pv-side-link{% if item.url == current %} is-active{% endif %}"
                   href="{{ item.url | relative_url }}"
                   {% if item.url == current %}aria-current="page"{% endif %}>
                  {{ item.title }}
                </a>
              </li>
            {% endfor %}
          </ul>
        </nav>

        <article class="pv-article" id="main-content">
          {{ content }}
        </article>
      </main>

      <footer class="pv-footer" role="contentinfo">
        <div class="pv-footer-inner">
          <span>© {{ site.time | date: '%Y' }} {{ site.title }}</span>
          <span class="pv-footer-sep">·</span>
          <a href="{{ '/feed.xml' | relative_url }}" class="pv-footer-link">rss</a>
        </div>
      </footer>
    </div>

    <script>
      (function() {
        const progressBar = document.querySelector('.reading-progress');
        const article = document.querySelector('.pv-article');
        
        if (!progressBar || !article) return;
        
        function updateProgress() {
          const windowHeight = window.innerHeight;
          const documentHeight = article.scrollHeight;
          const scrollTop = window.scrollY;
          const trackLength = documentHeight - windowHeight;
          const percent = Math.min(Math.floor((scrollTop / trackLength) * 100), 100);
          progressBar.style.width = percent + '%';
        }
        
        window.addEventListener('scroll', updateProgress, { passive: true });
        window.addEventListener('resize', updateProgress, { passive: true });
        updateProgress();
      })();
    </script>
  </body>
</html>
